# PDF 发票信息批量提取工具

本工具由 Python 实现，旨在自动化地从 PDF 格式的发票文件中提取关键信息，并将其整理到单个 CSV 表格文件中，可进一步转换为Excel使用。该工具利用 [Moonshot AI (Kimi)](https://www.moonshot.cn/) 的强大文件读取和信息提取能力，能够高效处理大量发票。

## ✨ 主要功能

  - **批量处理**: 自动扫描 `.\invoices` 文件夹内的所有 PDF 发票文件。
  - **智能提取**: 调用 Moonshot AI API，精准提取发票代码、号码、开票日期、购销方信息、金额、税额等关键字段。
  - **自动分类**: 根据发票内容，自动为费用确定类别（如餐饮、交通、办公用品等）。
  - **格式化输出**: 将所有提取的信息保存到一个 `invoices_data.csv` 文件中。
  - **文件重命名**: 成功处理的发票 PDF 会被重命名为 `{发票号码}-{开票日期}-{类别}-{价税合计}.pdf` 的格式，避免重复处理并易于归档。

## 🚀 快速开始

请按照以下步骤配置并运行脚本：

1.  **下载Release**: 下载Release中的zip打包。

2.  **创建 API 密钥文件**:

      - 在脚本所在的目录下，创建一个名为 `moonshot.txt` 的文本文件。
      - 打开此文件，将您的 [Moonshot API 密钥](https://platform.moonshot.cn/console/api-keys) 粘贴进去，然后保存。

    **注意**: 密钥文件中不应包含任何多余的空格或换行符。

3.  **创建发票文件夹**:

      - 在脚本所在的目录下，创建一个名为 `invoices` 的文件夹。

4.  **放入 PDF 文件**:

      - 将所有需要处理的 PDF 发票文件复制或移动到 `invoices` 文件夹中，**每个PDF中包含1个发票信息**。

5.  **运行脚本**:

      - 直接双击运行`InvoiceToCsvPy.exe`。

脚本将开始处理 `invoices` 文件夹中的所有 PDF 文件。处理完成后，您会看到 "处理完成！" 的提示。

## 📄 输出结果

  - **CSV 数据文件**: 脚本运行目录下会生成一个 `invoices_data.csv` 文件。您可以使用 Excel、Numbers 或任何文本编辑器打开它，查看所有提取出的发票信息。
  - **重命名的 PDF**: `invoices` 文件夹中被成功处理的 PDF 文件会被重命名。例如，一个文件可能被重命名为 `45311111-2024年12月30日-餐饮服务-188.pdf`。
